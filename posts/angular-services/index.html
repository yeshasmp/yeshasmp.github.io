<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Demystifying Angular Services and Dependency Injection | Yeshas M P</title>
<meta name=keywords content="Angular Services,Dependency Injection,Singleton">
<meta name=description content="Guide to Angular Services and Dependency Injection">
<meta name=author content="Yeshas M P">
<link rel=canonical href=https://yeshasmp.github.io/posts/angular-services/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.fda78ff6391c19c3ff97d0ecfcdb14a72b19b311e99388db7bf95506e2ab8ab7.css integrity="sha256-/aeP9jkcGcP/l9Ds/NsUpysZsxHpk4jbe/lVBuKrirc=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://yeshasmp.github.io/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://yeshasmp.github.io/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://yeshasmp.github.io/favicon-32x32.png>
<link rel=apple-touch-icon href=https://yeshasmp.github.io/apple-touch-icon.png>
<link rel=mask-icon href=https://yeshasmp.github.io/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.89.2">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript><meta property="og:title" content="Demystifying Angular Services and Dependency Injection">
<meta property="og:description" content="Guide to Angular Services and Dependency Injection">
<meta property="og:type" content="article">
<meta property="og:url" content="https://yeshasmp.github.io/posts/angular-services/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2022-04-15T00:00:00+00:00">
<meta property="article:modified_time" content="2022-04-15T00:00:00+00:00"><meta property="og:site_name" content="Yeshas M P">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Demystifying Angular Services and Dependency Injection">
<meta name=twitter:description content="Guide to Angular Services and Dependency Injection">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://yeshasmp.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Demystifying Angular Services and Dependency Injection","item":"https://yeshasmp.github.io/posts/angular-services/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Demystifying Angular Services and Dependency Injection","name":"Demystifying Angular Services and Dependency Injection","description":"Guide to Angular Services and Dependency Injection","keywords":["Angular Services","Dependency Injection","Singleton"],"articleBody":"In any Angular application it is essential to keep component as lean as possible, it’s only concern should be on how to present the model data to view as described by Angular official docs.\n “a component’s job is to enable the user experience and nothing more.”\n where other logics such as fetching data from API endpoint or handling client and server side errors should be taken care by services.\nAngular Services Angular services are simple class which is used to perform specific functions. Angular Services offer several advantages -\n It’s easier to write logic once in service and share the service among the components instead of writing the same logic in every component. It’s easier to test and debug. It’s easier maintain and perform code updates when required.  Angular Service Example We can generate Angular Service in Angular CLI using ng g s AppService where ‘g’ and ’s' is shorthand form for ‘generate service’.\nimport { Injectable } from '@angular/core'; @Injectable({ providedIn: 'root' }) export class AppService { constructor() { } alertMsg(msg : string) { alert(msg); } } Above service has method to launch alert popup with custom message. AppComponent can request AppService in it’s constructor and call the alertMsg method as shown below.\nimport { Component } from '@angular/core'; import { AppService } from '../app.service'; @Component({ selector: 'app-root', templateUrl: './app.component.html', styleUrls: ['./app.component.css'] }) export class AppComponent { constructor(private appService:AppService){ this.appService.alertMsg(\"App Component launched\"); } } } By default, Angular services are singleton. When services are registered either in provider array of root module or with providedIn value of ‘root’ or ‘any’ in the service itself there’s only single instance of service available throughout the application.\nWe understood how Angular service could be called in any component, but did you wonder how did AppComponent got an instance of AppService? For any class to execute another class method it needs to create an object of that class and call the method through it unless it’s static. But where did AppComponent create any instance of AppService?\nLet’s move into next section to know how AppComponent got an instance of AppService.\nDependency Injection When AppComponent get’s loaded, Angular would create and provide an instance of AppService to the AppComponent giving access to alertMsg method. This process is known as Dependency Injection. As stated in Wikipedia\n “In software engineering, dependency injection is a technique in which an object receives other objects that it depends on, called dependencies.”\n In Angular terms it’s “Responsibility of Angular framework to create an instance of service and provide it to the requested component”. The requested component need not know how and where to create service instance, it can simply request in it’s constructor and Angular would provide it.\nServices needs to register itself as dependency before any component can request it. There are 3 ways where service can register itself as dependency -\n Using providedIn property inside the @Injectable decorator of the service class itself. This is preferred way of registering a service as stated by Angular Docs since it tree shakable meaning Angular would include this service during build time if and only any component requests it. Otherwise this is excluded from the build which helps in improving the performance of our app.  @Injectable({ providedIn: 'root' }) By registering in provider array at Module level, Component level or Directive level. Service provided like below is not tree shakable and would be included in the build even if no component requests it.  providers: [ AppService ] By manually registering using @Inject inside constructor of consumer.  constructor(@Inject(AppService) private appService) A Provider is an object which holds list of all services registered in provider array. Angular creates provider and injector instance for root module and for each lazy loaded module. It also creates injector instance for all components and directives. Each Injector holds the provider list of all dependencies registered at respective component, directive or modules.\nNote - Angular doesn’t create injector instance for Eagerly Loaded modules therefore, the services registered at those modules will be configured in Root Module injector.\nTypical service when registered in provider array at module or component would look like below -\nprovders : [AppService] which is shorthand property when expanded would look like\nproviders : [{ provide : AppService , useClass : AppService }] provide property holds the injection token while provider property holds the instruction on how to create the dependency. Injection token can either be a type, a string or an injection token itself. We can not only provide class as dependency but also provide direct value or value returned from function or function itself using useValue, useFactory and useExisting provider properties. Visit Angular Docs to know more how you use other provider types.\nNow let’s breakdown how Angular would resolve the dependency using provider and injector in below steps for better understanding -\n  At runtime, Angular resolves dependency by following hierarchical injection tree. An injection tree is nothing but tree of injector instances.\n  By default, Angular creates Module Injector tree having one root module injector and seperate module injector for each lazy loaded module. At the top of root module injector sits Null and Platform module injectors. It also creates an Element Injector tree which holds injectors of all components and directives.\n  When AppComponent requests AppService Angular DI system at first will look at the provider array of AppComponent using the injection token given in the constructor.\n  If no provider is found in the AppComponent injector, then it traverse upto the parent components in search of matching provider using token until it reaches the root component injector in Element Injector tree.\n  If no providers are found in Element Injector tree then it searches in Module Injector tree. If the requested component is under lazy loaded module it searches in the provider of Lazy Loaded Module injector before proceeding to the Root Module injector.\n  When provider is found, it creates an instance of service and provide it to the requested component. If no provider is found in both Element Injector and Module Injector trees it reaches Null injector and throws NullInjectorError as shown below.\n  We can control the dependency resolution using @Skip, @SkipSelf, @Optional and @Host resolution modifiers. We can avoid the above null injector error when dependency is tagged with @Optional modifier in the requested AppComponent constructor like below. Then Angular would return null instead of throwing error.\nconstructor(@Optional private appService : AppService) Are Angular Services singleton? Let’s consider below code scenario to understand Hierarchical injection of services and whether Angular services are singleton or not. You can try and experiment below scenario using Stackblitz\nWe will create an AppService which generates random number when it’s instance is created and return that value through method. Initially we will register AppService only in root module using providedIn value as ‘root’ -\nimport { Injectable } from '@angular/core'; @Injectable({ providedIn: 'root' }) export class AppService { sharedValue : number; constructor() { this.sharedValue = Math.floor(Math.random() * 5); console.info(\"AppService instance has been created!\") } getSharedValue(){ return this.sharedValue; } } Let’s create two more components - AppComponent and HomeComponent a child of AppComponent and request the AppService in both the component constrcutor.\nAppComponent -\nimport { Component } from '@angular/core'; import { AppService } from './app.service'; @Component({ selector: 'app-root', templateUrl: './app.component.html', styleUrls: ['./app.component.css'] }) export class AppComponent { appServiceValue : any; constructor(private appService : AppService) { this.appServiceValue = this.appService.getRandomNumber(); } } HomeComponent -\nimport { Component, OnInit } from '@angular/core'; import { AppService } from '../app.service'; @Component({ selector: 'app-home', templateUrl: './home.component.html', styleUrls: ['./home.component.css'], //providers: [AppService] }) export class HomeComponent { appServiceValue : any; constructor(private appService : AppService) { this.appServiceValue = this.appService.getRandomNumber(); } } We will then display the random number in both app and home component by calling getRandomNumber method and passing the value to view. When we load the application we can see both components get the same random number as they both received same single instance of AppService from Root Module injector. This proves Angular services are singleton when they are registered only in Root Module provider.\nNow let’s register AppService also in HomeComponent provider and run the app. App and Home component displays two different random numbers because they both received two different instances of AppService. Thus we can say Angular services are not singleton when they are provided at different levels.\nBut how did two instance of Angular services got created?\n  When AppComponent requested the AppService, Angular looked for it in AppComponent provider at first, when it couldn’t find it it went into Module injector tree and found the AppService in Root Module provider and returned it to AppComponent.\n  Next when HomeComponent requested AppService it found it in the HomeComponent provider itself and returned new AppService instance to HomeComponent.\n  Therefore we saw two instance of AppService being created and provided to respective components.\n  Few points to remember before we conclude -\n  Element Injector tree always gets preference over Module Injector tree and it is not child of Module Injector tree.\n  Angular DI resolves dependencies using bottom to top approach, it starts the search for provider first from the requesting component and then traverse upto the parent components to the Root Module provider.\n  Service which are provided at Root Module or Eagerly Loaded Module are app scoped and accesible to all the components or directives. Services which are provided in Lazy Loaded Module are module scoped and available only to the components or directives under that module.\n  Proivder holds the list of dependencies with it’s matching token, while Injector holds provider itself.\n  If two Eagerly Loaded modules providers has service for same injector token then the module which is imported at last in Root Module gets preference.\n  Above code example have been shared over Github and Stackblitz.\nThat’s it folks! I hope this article helped you understand better how Angular Dependency works and how Angular Services are singleton by nature.\nStay tuned for more such interesting articles!\n","wordCount":"1642","inLanguage":"en","datePublished":"2022-04-15T00:00:00Z","dateModified":"2022-04-15T00:00:00Z","author":{"@type":"Person","name":"Yeshas M P"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://yeshasmp.github.io/posts/angular-services/"},"publisher":{"@type":"Organization","name":"Yeshas M P","logo":{"@type":"ImageObject","url":"https://yeshasmp.github.io/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://yeshasmp.github.io/ accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://yeshasmp.github.io/about/ title=About>
<span>About</span>
</a>
</li>
<li>
<a href=https://yeshasmp.github.io/archives/ title=Archives>
<span>Archives</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://yeshasmp.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://yeshasmp.github.io/posts/>Posts</a></div>
<h1 class=post-title>
Demystifying Angular Services and Dependency Injection
</h1>
<div class=post-description>
Guide to Angular Services and Dependency Injection
</div>
<div class=post-meta><span title="2022-04-15 00:00:00 +0000 UTC">April 15, 2022</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;Yeshas M P
</div>
</header> <div class=toc>
<details open>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul>
<li>
<a href=#angular-services aria-label="Angular Services">Angular Services</a><ul>
<li>
<a href=#angular-service-example aria-label="Angular Service Example">Angular Service Example</a></li></ul>
</li>
<li>
<a href=#dependency-injection aria-label="Dependency Injection">Dependency Injection</a></li>
<li>
<a href=#are-angular-services-singleton aria-label="Are Angular Services singleton?">Are Angular Services singleton?</a>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><p>In any Angular application it is essential to keep component as lean as possible, it&rsquo;s only concern should be on how to present the model data to view as described by <a href=https://angular.io/guide/architecture-services>Angular official docs</a>.</p>
<blockquote>
<p>&ldquo;a component&rsquo;s job is to enable the user experience and nothing more.&rdquo;</p>
</blockquote>
<p>where other logics such as fetching data from API endpoint or handling client and server side errors should be taken care by services.</p>
<h2 id=angular-services>Angular Services<a hidden class=anchor aria-hidden=true href=#angular-services>#</a></h2>
<p>Angular services are simple class which is used to perform specific functions. Angular Services offer several advantages -</p>
<ol>
<li>It&rsquo;s easier to write logic once in service and share the service among the components instead of writing the same logic in every component.</li>
<li>It&rsquo;s easier to test and debug.</li>
<li>It&rsquo;s easier maintain and perform code updates when required.</li>
</ol>
<h3 id=angular-service-example>Angular Service Example<a hidden class=anchor aria-hidden=true href=#angular-service-example>#</a></h3>
<p>We can generate Angular Service in Angular CLI using <code>ng g s AppService</code> where &lsquo;g&rsquo; and &rsquo;s' is shorthand form for &lsquo;generate service&rsquo;.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Injectable</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;

<span style=color:#66d9ef>@Injectable</span>({
  <span style=color:#a6e22e>providedIn</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;root&#39;</span>
})

<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AppService</span> {
  <span style=color:#66d9ef>constructor</span>() { }
  <span style=color:#a6e22e>alertMsg</span>(<span style=color:#a6e22e>msg</span> : <span style=color:#66d9ef>string</span>) {
      <span style=color:#a6e22e>alert</span>(<span style=color:#a6e22e>msg</span>);
  }
}
</code></pre></div><p>Above service has method to launch alert popup with custom message. <code>AppComponent</code> can request <code>AppService</code> in it&rsquo;s constructor and call the alertMsg method as shown below.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Component</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;
<span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>AppService</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../app.service&#39;</span>;

<span style=color:#66d9ef>@Component</span>({
  <span style=color:#a6e22e>selector</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;app-root&#39;</span>,
  <span style=color:#a6e22e>templateUrl</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./app.component.html&#39;</span>,
  <span style=color:#a6e22e>styleUrls</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;./app.component.css&#39;</span>]
})

<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AppComponent</span> {
  <span style=color:#66d9ef>constructor</span>(<span style=color:#66d9ef>private</span> <span style=color:#a6e22e>appService</span>:<span style=color:#66d9ef>AppService</span>){
      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>appService</span>.<span style=color:#a6e22e>alertMsg</span>(<span style=color:#e6db74>&#34;App Component launched&#34;</span>);
  }
}
}
</code></pre></div><p>By default, Angular services are singleton. When services are registered either in provider array of root module or with providedIn value of &lsquo;root&rsquo; or &lsquo;any&rsquo; in the service itself there&rsquo;s only single instance of service available throughout the application.</p>
<p>We understood how Angular service could be called in any component, but did you wonder how did <code>AppComponent</code> got an instance of <code>AppService</code>? For any class to execute another class method it needs to create an object of that class and call the method through it unless it&rsquo;s static. But where did <code>AppComponent</code> create any instance of <code>AppService</code>?</p>
<p>Let&rsquo;s move into next section to know how <code>AppComponent</code> got an instance of <code>AppService</code>.</p>
<h2 id=dependency-injection>Dependency Injection<a hidden class=anchor aria-hidden=true href=#dependency-injection>#</a></h2>
<p>When <code>AppComponent</code> get&rsquo;s loaded, Angular would create and provide an instance of <code>AppService</code> to the <code>AppComponent</code> giving access to <code>alertMsg</code> method. This process is known as <code>Dependency Injection</code>. As stated in <a href=https://en.wikipedia.org/wiki/Dependency_injection>Wikipedia</a></p>
<blockquote>
<p>&ldquo;In software engineering, dependency injection is a technique in which an object receives other objects that it depends on, called dependencies.&rdquo;</p>
</blockquote>
<p>In Angular terms it&rsquo;s &ldquo;Responsibility of Angular framework to create an instance of service and provide it to the requested component&rdquo;. The requested component need not know how and where to create service instance, it can simply request in it&rsquo;s constructor and Angular would provide it.</p>
<p>Services needs to register itself as dependency before any component can request it. There are 3 ways where service can register itself as dependency -</p>
<ol>
<li>Using providedIn property inside the <code>@Injectable</code> decorator of the service class itself. This is preferred way of registering a service as stated by Angular Docs since it tree shakable meaning Angular would include this service during build time if and only any component requests it. Otherwise this is excluded from the build which helps in improving the performance of our app.</li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=color:#66d9ef>@Injectable</span>({
  <span style=color:#a6e22e>providedIn</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;root&#39;</span>
})
</code></pre></div><ol start=2>
<li>By registering in provider array at Module level, Component level or Directive level. Service provided like below is not tree shakable and would be included in the build even if no component requests it.</li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=color:#a6e22e>providers</span><span style=color:#f92672>:</span>  [ <span style=color:#a6e22e>AppService</span> ]
</code></pre></div><ol start=3>
<li>By manually registering using <code>@Inject</code> inside constructor of consumer.</li>
</ol>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=color:#66d9ef>constructor</span>(<span style=color:#66d9ef>@Inject</span>(<span style=color:#a6e22e>AppService</span>) <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>appService</span>)
</code></pre></div><p>A <code>Provider</code> is an object which holds list of all services registered in provider array. Angular creates provider and injector instance for root module and for each lazy loaded module. It also creates injector instance for all components and directives. Each <code>Injector</code> holds the provider list of all dependencies registered at respective component, directive or modules.</p>
<p>Note - Angular doesn&rsquo;t create injector instance for <code>Eagerly Loaded modules</code> therefore, the services registered at those modules will be configured in <code>Root Module injector</code>.</p>
<p>Typical service when registered in provider array at module or component would look like below -</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=color:#a6e22e>provders</span> <span style=color:#f92672>:</span> [<span style=color:#a6e22e>AppService</span>]
</code></pre></div><p>which is shorthand property when expanded would look like</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=color:#a6e22e>providers</span> <span style=color:#f92672>:</span> [{ <span style=color:#a6e22e>provide</span> : <span style=color:#66d9ef>AppService</span> , <span style=color:#a6e22e>useClass</span> : <span style=color:#66d9ef>AppService</span> }]
</code></pre></div><p><code>provide</code> property holds the injection token while <code>provider</code> property holds the instruction on how to create the dependency. Injection token can either be a type, a string or an injection token itself. We can not only provide class as dependency but also provide direct value or value returned from function or function itself using <code>useValue</code>, <code>useFactory</code> and <code>useExisting</code> provider properties. Visit <a href=https://angular.io/guide/dependency-injection-providers>Angular Docs</a> to know more how you use other provider types.</p>
<p>Now let&rsquo;s breakdown how Angular would resolve the dependency using provider and injector in below steps for better understanding -</p>
<p><img loading=lazy src=/images/hierarchical-tree-flowchart.jpg#center alt="Hierarchical Injection">
</p>
<ol>
<li>
<p>At runtime, Angular resolves dependency by following hierarchical injection tree. An injection tree is nothing but tree of injector instances.</p>
</li>
<li>
<p>By default, Angular creates <code>Module Injector tree</code> having one root module injector and seperate module injector for each lazy loaded module. At the top of root module injector sits Null and Platform module injectors. It also creates an <code>Element Injector tree</code> which holds injectors of all components and directives.</p>
</li>
<li>
<p>When <code>AppComponent</code> requests <code>AppService</code> Angular DI system at first will look at the provider array of <code>AppComponent</code> using the injection token given in the constructor.</p>
</li>
<li>
<p>If no provider is found in the <code>AppComponent</code> injector, then it traverse upto the parent components in search of matching provider using token until it reaches the root component injector in <code>Element Injector tree</code>.</p>
</li>
<li>
<p>If no providers are found in <code>Element Injector tree</code> then it searches in <code>Module Injector tree</code>. If the requested component is under lazy loaded module it searches in the provider of <code>Lazy Loaded Module injector</code> before proceeding to the <code>Root Module injector</code>.</p>
</li>
<li>
<p>When provider is found, it creates an instance of service and provide it to the requested component. If no provider is found in both <code>Element Injector</code> and <code>Module Injector</code> trees it reaches Null injector and throws <code>NullInjectorError</code> as shown below.</p>
</li>
</ol>
<p><img loading=lazy src=/images/null-error.jpg#center alt="Angular service null injector error">
</p>
<p>We can control the dependency resolution using @Skip, @SkipSelf, @Optional and @Host resolution modifiers. We can avoid the above null injector error when dependency is tagged with <code>@Optional</code> modifier in the requested <code>AppComponent</code> constructor like below. Then Angular would return null instead of throwing error.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=color:#66d9ef>constructor</span>(<span style=color:#66d9ef>@Optional</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>appService</span> : <span style=color:#66d9ef>AppService</span>)
</code></pre></div><h2 id=are-angular-services-singleton>Are Angular Services singleton?<a hidden class=anchor aria-hidden=true href=#are-angular-services-singleton>#</a></h2>
<p>Let&rsquo;s consider below code scenario to understand Hierarchical injection of services and whether Angular services are singleton or not. You can try and experiment below scenario using <a href=https://stackblitz.com/edit/angular-ivy-r6cden>Stackblitz</a></p>
<p>We will create an <code>AppService</code> which generates random number when it&rsquo;s instance is created and return that value through method. Initially we will register <code>AppService</code> only in root module using <code>providedIn</code> value as &lsquo;root&rsquo; -</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Injectable</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;

<span style=color:#66d9ef>@Injectable</span>({
  <span style=color:#a6e22e>providedIn</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;root&#39;</span>
})
<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AppService</span> {

  <span style=color:#a6e22e>sharedValue</span> : <span style=color:#66d9ef>number</span>;

  <span style=color:#66d9ef>constructor</span>() { 
    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>sharedValue</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> <span style=color:#ae81ff>5</span>);
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#34;AppService instance has been created!&#34;</span>)
  }

  <span style=color:#a6e22e>getSharedValue</span>(){
    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>sharedValue</span>;
  }
}
</code></pre></div><p>Let&rsquo;s create two more components - <code>AppComponent</code> and <code>HomeComponent</code> a child of <code>AppComponent</code> and request the <code>AppService</code> in both the component constrcutor.</p>
<p><code>AppComponent</code> -</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Component</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;
<span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>AppService</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./app.service&#39;</span>;

<span style=color:#66d9ef>@Component</span>({
  <span style=color:#a6e22e>selector</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;app-root&#39;</span>,
  <span style=color:#a6e22e>templateUrl</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./app.component.html&#39;</span>,
  <span style=color:#a6e22e>styleUrls</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;./app.component.css&#39;</span>]
})
<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AppComponent</span> {

  <span style=color:#a6e22e>appServiceValue</span> : <span style=color:#66d9ef>any</span>;

  <span style=color:#66d9ef>constructor</span>(<span style=color:#66d9ef>private</span> <span style=color:#a6e22e>appService</span> : <span style=color:#66d9ef>AppService</span>) { 
    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>appServiceValue</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>appService</span>.<span style=color:#a6e22e>getRandomNumber</span>();
  }
}
</code></pre></div><p><code>HomeComponent</code> -</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Component</span>, <span style=color:#a6e22e>OnInit</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@angular/core&#39;</span>;
<span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>AppService</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;../app.service&#39;</span>;

<span style=color:#66d9ef>@Component</span>({
  <span style=color:#a6e22e>selector</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;app-home&#39;</span>,
  <span style=color:#a6e22e>templateUrl</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;./home.component.html&#39;</span>,
  <span style=color:#a6e22e>styleUrls</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;./home.component.css&#39;</span>],
  <span style=color:#75715e>//providers: [AppService]
</span><span style=color:#75715e></span>})
<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>HomeComponent</span> {

  <span style=color:#a6e22e>appServiceValue</span> : <span style=color:#66d9ef>any</span>;

  <span style=color:#66d9ef>constructor</span>(<span style=color:#66d9ef>private</span> <span style=color:#a6e22e>appService</span> : <span style=color:#66d9ef>AppService</span>) { 
    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>appServiceValue</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>appService</span>.<span style=color:#a6e22e>getRandomNumber</span>();
  }

}
</code></pre></div><p>We will then display the random number in both app and home component by calling getRandomNumber method and passing the value to view. When we load the application we can see both components get the same random number as they both received same single instance of <code>AppService</code> from <code>Root Module injector</code>. This proves Angular services are singleton when they are registered only in <code>Root Module provider</code>.</p>
<p><img loading=lazy src=/images/singleton.jpg#center alt="Angular singleton service">
</p>
<p>Now let&rsquo;s register <code>AppService</code> also in <code>HomeComponent</code> provider and run the app. App and Home component displays two different random numbers because they both received two different instances of <code>AppService</code>. Thus we can say Angular services are not singleton when they are provided at different levels.</p>
<p><img loading=lazy src=/images/non-singleton.jpg#center alt="Angular non-singleton service">
</p>
<p>But how did two instance of Angular services got created?</p>
<p><img loading=lazy src=/images/hierarchical-injection-tree.jpg#center alt="Angular Hierarchical Injection">
</p>
<ol>
<li>
<p>When <code>AppComponent</code> requested the <code>AppService</code>, Angular looked for it in <code>AppComponent</code> provider at first, when it couldn&rsquo;t find it it went into <code>Module injector tree</code> and found the <code>AppService</code> in <code>Root Module provider</code> and returned it to <code>AppComponent</code>.</p>
</li>
<li>
<p>Next when <code>HomeComponent</code> requested <code>AppService</code> it found it in the <code>HomeComponent</code> provider itself and returned new <code>AppService</code> instance to <code>HomeComponent</code>.</p>
</li>
<li>
<p>Therefore we saw two instance of <code>AppService</code> being created and provided to respective components.</p>
</li>
</ol>
<p>Few points to remember before we conclude -</p>
<ol>
<li>
<p><code>Element Injector tree</code> always gets preference over <code>Module Injector tree</code> and it is not child of <code>Module Injector tree</code>.</p>
</li>
<li>
<p>Angular DI resolves dependencies using bottom to top approach, it starts the search for provider first from the requesting component and then traverse upto the parent components to the <code>Root Module provider</code>.</p>
</li>
<li>
<p>Service which are provided at <code>Root Module</code> or <code>Eagerly Loaded Module</code> are app scoped and accesible to all the components or directives. Services which are provided in <code>Lazy Loaded Module</code> are module scoped and available only to the components or directives under that module.</p>
</li>
<li>
<p><code>Proivder</code> holds the list of dependencies with it&rsquo;s matching token, while <code>Injector</code> holds provider itself.</p>
</li>
<li>
<p>If two <code>Eagerly Loaded modules</code> providers has service for same injector token then the module which is imported at last in <code>Root Module</code> gets preference.</p>
</li>
</ol>
<p>Above code example have been shared over <a href=https://github.com/yeshasmp/AngularService>Github</a> and <a href=https://stackblitz.com/edit/angular-ivy-r6cden>Stackblitz</a>.</p>
<p>That&rsquo;s it folks! I hope this article helped you understand better how Angular Dependency works and how Angular Services are singleton by nature.</p>
<p>Stay tuned for more such interesting articles!</p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://yeshasmp.github.io/tags/angular-services/>Angular Services</a></li>
<li><a href=https://yeshasmp.github.io/tags/dependency-injection/>Dependency Injection</a></li>
<li><a href=https://yeshasmp.github.io/tags/singleton/>Singleton</a></li>
</ul>
<nav class=paginav>
<a class=next href=https://yeshasmp.github.io/posts/angular-bootstrapping/>
<span class=title>Next Page »</span>
<br>
<span>Angular Bootstrapping : How does Angular work under the hood?</span>
</a>
</nav>
<div class=share-buttons>
<a target=_blank rel="noopener noreferrer" aria-label="share Demystifying Angular Services and Dependency Injection on twitter" href="https://twitter.com/intent/tweet/?text=Demystifying%20Angular%20Services%20and%20Dependency%20Injection&url=https%3a%2f%2fyeshasmp.github.io%2fposts%2fangular-services%2f&hashtags=AngularServices%2cDependencyInjection%2cSingleton"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Demystifying Angular Services and Dependency Injection on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fyeshasmp.github.io%2fposts%2fangular-services%2f&title=Demystifying%20Angular%20Services%20and%20Dependency%20Injection&summary=Demystifying%20Angular%20Services%20and%20Dependency%20Injection&source=https%3a%2f%2fyeshasmp.github.io%2fposts%2fangular-services%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Demystifying Angular Services and Dependency Injection on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fyeshasmp.github.io%2fposts%2fangular-services%2f&title=Demystifying%20Angular%20Services%20and%20Dependency%20Injection"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Demystifying Angular Services and Dependency Injection on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fyeshasmp.github.io%2fposts%2fangular-services%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Demystifying Angular Services and Dependency Injection on whatsapp" href="https://api.whatsapp.com/send?text=Demystifying%20Angular%20Services%20and%20Dependency%20Injection%20-%20https%3a%2f%2fyeshasmp.github.io%2fposts%2fangular-services%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Demystifying Angular Services and Dependency Injection on telegram" href="https://telegram.me/share/url?text=Demystifying%20Angular%20Services%20and%20Dependency%20Injection&url=https%3a%2f%2fyeshasmp.github.io%2fposts%2fangular-services%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg>
</a>
</div>
</footer>
</article>
</main>
<footer class=footer>
<span>Copyright &copy; 2022 <a href=https://yeshasmp.github.io/>Yeshas M P</a></span>
<br>
<span>
This blog is licensed under a <a rel=license target=_blank href=http://creativecommons.org/licenses/by/4.0/>Creative Commons Attribution 4.0 International License</a>. Unless otherwise stated or granted, code samples licensed under the <a rel=license target=_blank href=https://github.com/yeshasmp/yeshasmp.github.io/blob/main/LICENSE.md>MIT License</a>.
</span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>. Hosted with ❤ by Github.
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "d67643a519cb43b7863572cd67e86404"}'></script>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>